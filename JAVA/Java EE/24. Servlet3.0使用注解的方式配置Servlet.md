## 一、Servlet的传统配置方式

　　在JavaWeb开发中， 每次编写一个Servlet都需要在web.xml文件中进行配置，如下所示：

[![复制代码](https://assets.cnblogs.com/images/copycode.gif)](javascript:void(0);)

```
1 <servlet>
2     <servlet-name>ActionServlet</servlet-name>
3     <servlet-class>me.gacl.web.controller.ActionServlet</servlet-class>
4 </servlet>
5 
6 <servlet-mapping>
7     <servlet-name>ActionServlet</servlet-name>
8     <url-pattern>/servlet/ActionServlet</url-pattern>
9 </servlet-mapping>
```

[![复制代码](https://assets.cnblogs.com/images/copycode.gif)](javascript:void(0);)

　　每开发一个Servlet，都要在web.xml中配置Servlet才能够使用，这实在是很头疼的事情，所以Servlet3.0之后提供了注解(annotation)，使得不再需要在web.xml文件中进行Servlet的部署描述，简化开发流程。



## 注解配置方式

Servlet 3.0 之后引入了注解（annotation）来简化配置，减少了对 `web.xml` 的依赖。通过注解，开发者可以在类级别配置 Servlet、过滤器（Filter）和监听器（Listener）。以下是 Servlet 3.0 之后常用的注解：

### 1. **@WebServlet**

用于定义和配置 Servlet，而无需在 `web.xml` 中手动注册。

- **属性**：

	- `name`：指定 Servlet 的名称（可选）。
	- `urlPatterns` 或 `value`：指定 Servlet 的 URL 映射模式。
	- `initParams`：初始化参数，`@WebInitParam` 类型的数组。
	- `loadOnStartup`：指定 Servlet 的加载顺序（整数值，0 或正数表示启动时加载，负数表示延迟加载）。
	- `asyncSupported`：是否支持异步模式（默认为 `false`）。

- **示例**：

	```
	java复制代码@WebServlet(name = "MyServlet", urlPatterns = {"/myServlet"}, loadOnStartup = 1)
	public class MyServlet extends HttpServlet {
	    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
	        response.getWriter().write("Hello from MyServlet!");
	    }
	}
	```

### 2. **@WebFilter**

用于定义和配置过滤器（Filter），无需在 `web.xml` 中手动注册。

- **属性**：

	- `filterName`：指定过滤器的名称（可选）。
	- `urlPatterns` 或 `value`：指定过滤器应用的 URL 映射模式。
	- `initParams`：初始化参数，`@WebInitParam` 类型的数组。
	- `dispatcherTypes`：指定过滤器的调度类型（如 `REQUEST`, `FORWARD`, `INCLUDE`, `ASYNC` 等）。
	- `asyncSupported`：是否支持异步模式（默认为 `false`）。

- **示例**：

	```
	java复制代码@WebFilter(filterName = "MyFilter", urlPatterns = {"/myServlet"})
	public class MyFilter implements Filter {
	    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
	            throws IOException, ServletException {
	        System.out.println("Filter applied");
	        chain.doFilter(request, response);
	    }
	}
	```

### 3. **@WebListener**

用于定义监听器（Listener），无需在 `web.xml` 中手动注册。可以监听上下文、会话等生命周期事件。

- 示例

	：

	```
	java复制代码@WebListener
	public class MyListener implements ServletContextListener {
	    @Override
	    public void contextInitialized(ServletContextEvent sce) {
	        System.out.println("Context Initialized");
	    }
	
	    @Override
	    public void contextDestroyed(ServletContextEvent sce) {
	        System.out.println("Context Destroyed");
	    }
	}
	```

### 4. **@WebInitParam**

用于定义 Servlet 或 Filter 的初始化参数。通常与 `@WebServlet` 或 `@WebFilter` 注解结合使用。

- **属性**：

	- `name`：参数的名称。
	- `value`：参数的值。
	- `description`：参数的描述（可选）。

- **示例**：

	```
	java复制代码@WebServlet(name = "MyServlet", urlPatterns = {"/myServlet"},
	            initParams = {@WebInitParam(name = "param1", value = "value1")})
	public class MyServlet extends HttpServlet {
	    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
	        String paramValue = getServletConfig().getInitParameter("param1");
	        response.getWriter().write("Parameter value: " + paramValue);
	    }
	}
	```

### 5. **@MultipartConfig**

用于标注支持文件上传的 Servlet。这是 Servlet 3.0 规范中新增的特性，用来处理 `multipart/form-data` 类型的表单请求。

- **属性**：

	- `location`：指定文件的临时存储目录。
	- `maxFileSize`：上传文件的最大大小（以字节为单位）。
	- `maxRequestSize`：整个请求的最大大小。
	- `fileSizeThreshold`：当上传文件大小超过此值时，文件将被写入磁盘。

- **示例**：

	```java
	@WebServlet("/uploadServlet")
	@MultipartConfig(location = "/tmp", maxFileSize = 1048576, maxRequestSize = 5242880, fileSizeThreshold = 1024)
	public class UploadServlet extends HttpServlet {
	    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
	        Part filePart = request.getPart("file"); // 获取上传的文件
	        String fileName = Paths.get(filePart.getSubmittedFileName()).getFileName().toString(); 
	        InputStream fileContent = filePart.getInputStream();
	        // 处理文件上传
	    }
	}
	```

### 6. **@ServletSecurity**

用于指定 Servlet 的安全约束，结合 `@HttpConstraint` 和 `@HttpMethodConstraint` 来定义访问控制。

- 示例

	：

	```
	java复制代码@WebServlet("/secureServlet")
	@ServletSecurity(@HttpConstraint(rolesAllowed = "admin"))
	public class SecureServlet extends HttpServlet {
	    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
	        response.getWriter().write("Access granted to admin!");
	    }
	}
	```

### 总结：

Servlet 3.0 之后引入的注解简化了配置，减少了对 `web.xml` 的依赖。常用注解包括 `@WebServlet`、`@WebFilter`、`@WebListener`，以及支持文件上传的 `@MultipartConfig` 和安全配置的 `@ServletSecurity`。这些注解极大地提升了开发效率，使得 Servlet 和 Filter 的配置更加直观易懂。